{% extends 'base.html.twig' %}

{% block title %}{{ formation.title }}{% endblock %}

{% block body %}
	<div class="max-w-4xl mx-auto px-4 py-8">
		<h1 class="text-2xl font-bold text-gray-800 mb-4">{{ formation.title }}</h1>

		{% if app.user %}
			{% if inscription %}
				<div class="mb-6 p-4 border border-blue-200 bg-blue-50 text-blue-800 rounded-lg">
					âœ… Vous Ãªtes inscrit(e) Ã  cette formation.
					{% if inscription.progression > 0 %}
						<br>ðŸ“Š Progression : {{ inscription.progression }}%
					{% endif %}
				</div>
			{% else %}
				<form method="post" action="{{ path('formation_inscription', { slug: formation.slug }) }}" class="mb-6">
					<button type="submit"
						class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 text-sm font-medium">
						S'inscrire Ã  cette formation
					</button>
				</form>
			{% endif %}
		{% else %}
			<p class="text-sm text-gray-600 mb-6">
				<a href="{{ path('app_login') }}" class="text-indigo-600 hover:underline">Connectez-vous</a>
				pour vous inscrire.
			</p>
		{% endif %}

		<p class="text-gray-700 mb-8">{{ formation.description }}</p>

		<h2 class="text-xl font-semibold text-gray-800 mb-4">Modules</h2>
		{% if formation.modules|length > 0 %}
			<ul class="space-y-4 mb-10">
				{% for module in formation.modules %}
					<li class="border border-gray-200 p-4 rounded-lg bg-white">
						<h3 class="text-lg font-semibold text-gray-700 mb-1">{{ module.title }}</h3>
						<p class="text-sm text-gray-600 mb-2">{{ module.content|nl2br }}</p>
						{% if module.file %}
							<a href="{{ asset('uploads/files/' ~ module.file) }}" target="_blank"
							   class="text-indigo-600 hover:underline text-sm">
								ðŸ“¥ TÃ©lÃ©charger le fichier
							</a>
						{% endif %}
					</li>
				{% endfor %}
			</ul>
		{% else %}
			<p class="text-gray-600 mb-10">Aucun module pour cette formation.</p>
		{% endif %}

		<h2 class="text-xl font-semibold text-gray-800 mb-4">Quiz</h2>
		{% if formation.quizzes|length > 0 %}
			<ul class="space-y-4">
				{% for quiz in formation.quizzes %}
					<li class="flex items-center justify-between bg-white border border-gray-200 p-4 rounded-lg">
						<span class="text-gray-700 font-medium">{{ quiz.title }}</span>
						<a href="#"
						   class="text-sm text-indigo-600 hover:underline font-medium">Lancer le quiz</a>
					</li>
				{% endfor %}
			</ul>
		{% else %}
			<p class="text-gray-600">Pas de quiz associÃ© pour le moment.</p>
		{% endif %}
	</div>
{% endblock %}
