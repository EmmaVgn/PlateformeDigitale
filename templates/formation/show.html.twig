{% extends 'base.html.twig' %}

{% block title %}
	{{ formation.title }}
{% endblock %}

{% block body %}
	<div
		class="relative">
		<!-- Bandeau -->
		<div class="bg-primary text-white py-16 ">
			<div class="max-w-7xl mx-auto flex justify-between items-center">
				<h1 class="text-4xl font-bold">{{ formation.title }}</h1>
				<p class="text-xl">Formation en ligne avec Cam√©l√©on Solutions</p>
			</div>
		</div>

		<!-- Container for main content and sticky card -->
		<div class="mx-auto px-4 mt-8">
			<div
				class="max-w-7xl flex gap-8 relative">
				<!-- Main Content -->
				<div
					class="flex-1">
					<!-- Menu de navigation -->
					<nav class="py-4  top-0 z-10 shadow-md pl-8">
						<ul class="flex space-x-8">
							<li>
								<a href="#details" class="text-lg text-primary hover:underline active">D√©tail</a>
							</li>
							<li>
								<a href="#localite" class="text-lg text-primary hover:underline">Localit√©</a>
							</li>
							<li>
								<a href="#objectif" class="text-lg text-primary hover:underline">Objectif</a>
							</li>
							<li>
								<a href="#programme" class="text-lg text-primary hover:underline">Programme</a>
							</li>
							<li>
								<a href="#prix" class="text-lg text-primary hover:underline">Prix</a>
							</li>

							{% if app.user and inscription and inscription.isValidated %}
								<li>
									<a href="#modules" class="text-lg text-indigo-600 hover:underline">Modules</a>
								</li>
								<li>
									<a href="#quiz" class="text-lg text-indigo-600 hover:underline">Quiz</a>
								</li>
							{% endif %}
						</ul>
					</nav>


					<!-- Contenu avec plus de contenu pour permettre le d√©filement -->
					<div class="py-8">
						<div id="details" class="mb-12">
							<h2 class="text-2xl font-semibold mb-4">D√©tail</h2>
							<p class="mb-4">{{ formation.description }}</p>
						</div>

						<div id="localite" class="mb-12">
							<h2 class="text-2xl font-semibold mb-4">Localit√©</h2>
							<p>{{ formation.lieu }}</p>
						</div>

						<div id="objectif" class="mb-12">
							<h2 class="text-2xl font-semibold mb-4">Objectif</h2>
							<p>{{ formation.objectifDeFormation }}</p>
						</div>

						<div id="programme" class="mb-12">
							<h2 class="text-2xl font-semibold mb-4">Programme</h2>
							<p>{{ formation.programme }}</p>
						</div>

						<div id="prix" class="mb-12">
							<h2 class="text-2xl font-semibold mb-4">Prix</h2>
							<p>{{ formation.coutEtFinancement }}
								‚Ç¨</p>
						</div>
					</div>

					{# --- Affichage conditionnel des modules et quiz --- #}
					{% if inscription and inscription.isValidated %}
						<div id="modules" class="mb-12">
							<h2 class="text-2xl font-semibold mb-4">Modules</h2>
							{% if formation.modules|length > 0 %}
								<ul class="space-y-4 mb-10">
									{% for module in formation.modules %}
										<li class="border border-gray-200 p-4 rounded-lg bg-white">
											<h3 class="text-lg font-semibold text-gray-700 mb-1">{{ module.title }}</h3>
											<p class="text-sm text-gray-600 mb-2">{{ module.content|nl2br }}</p>
											{% if module.file %}
												<a href="{{ asset('uploads/files/' ~ module.file) }}" target="_blank" class="text-indigo-600 hover:underline text-sm">
													üì• T√©l√©charger le fichier
												</a>
											{% endif %}
										</li>
									{% endfor %}
								</ul>
							{% else %}
								<p class="text-gray-600 mb-10">Aucun module pour cette formation.</p>
							{% endif %}
						</div>

						<div id="quiz" class="mb-12">
							<h2 class="text-2xl font-semibold mb-4">Quiz</h2>
							{% if formation.quizzes|length > 0 %}
								<ul class="space-y-4">
									{% for quiz in formation.quizzes %}
										<li class="flex items-center justify-between bg-white border border-gray-200 p-4 rounded-lg">
											<span class="text-gray-700 font-medium">{{ quiz.title }}</span>
											<a href="#" class="text-sm text-indigo-600 hover:underline font-medium">Lancer le quiz</a>
										</li>
									{% endfor %}
								</ul>
							{% else %}
								<p class="text-gray-600">Pas de quiz associ√© pour le moment.</p>
							{% endif %}
						</div>
					{% else %}
						<div class="mt-10 p-4 bg-yellow-50 border border-primary text-yellow-800 rounded">
							Le contenu p√©dagogique est r√©serv√© aux personnes inscrites et valid√©es par l‚Äôadministrateur.
						</div>
					{% endif %}
				</div>

				<!-- Card Sticky √† droite -->
				<div class="w-80">
					<div class="sticky top-4">
						<div class="bg-white shadow-lg rounded-lg p-6">
							<div class="flex items-center mb-4">
								<img src="{{ asset('img/Cameleon-noir.svg') }}" alt="Logo Cam√©l√©on Solutions Learning" class="w-16 h-16 mr-4">
								<h2 class="font-semibold text-lg">Cam√©l√©on Solutions Learning</h2>
							</div>

							{% if app.user %}
								{% if inscription %}
									<div class="mb-6 p-4 border border-blue-200 bg-blue-50 text-blue-800 rounded-lg">
										‚úÖ Vous √™tes inscrit(e) √† cette formation.
										{% if inscription.progression > 0 %}
											<br>üìä Progression :
											{{ inscription.progression }}%
										{% endif %}
										{% if not inscription.isValidated %}
											<br>‚è≥ En attente de validation par l‚Äôadministrateur.
										{% endif %}
									</div>
								{% else %}
									<form method="post" action="{{ path('formation_inscription', { slug: formation.slug }) }}" class="mb-6">
										<button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 text-sm font-medium">
											S'inscrire √† cette formation
										</button>
									</form>
								{% endif %}
							{% else %}
								<p class="sticky-ahref text-sm text-gray-600 mb-6">
									<a href="{{ path('app_login') }}" class="text-indigo-600 hover:underline outline outline-2 outline-white outline-offset-2">
										Connectez-vous
									</a>
									pour avoir acc√®s √† la formation.
								</p>
								<p class="sticky-ahref text-sm text-gray-600 mb-6">
									<a href="mailto:contact@cameleon-solutions.fr?subject=Demande d'informations sur la formation [Nom de la formation]&body=Bonjour,%0A%0AJe souhaite avoir plus d'informations sur la formation [Nom de la formation en question].%0A%0ACordialement." class="text-indigo-600 hover:underline">
										Demandez plus d'informations</a>
									sur la formation.
								</p>
							</a>

						</p>

					{% endif %}
				</div>
			</div>
		</div>
	</div>
</div></div>{% endblock %}
